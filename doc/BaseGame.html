<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BaseGame</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_BaseGame.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/BaseGame.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">bartok-0.0.0.1</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">BaseGame</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This contains functions for a simple game.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:doNothing">doNothing</a> :: <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:fromStep">fromStep</a> :: <a href="DataTypes.html#t:Step">Step</a> -&gt; <a href="DataTypes.html#t:Game">Game</a></li><li class="src short"><a href="#v:if-39--39-">if''</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; (a -&gt; a) -&gt; a -&gt; a</li><li class="src short"><a href="#v:-37-">(%)</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:-37--37-">(%%)</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:illegal">illegal</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Game">Game</a></li><li class="src short"><a href="#v:penalty">penalty</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:broadcastp">broadcastp</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:sayAct">sayAct</a> :: <a href="DataTypes.html#t:Game">Game</a></li><li class="src short"><a href="#v:addPlayer">addPlayer</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="DataTypes.html#t:Name">Name</a>, <a href="DataTypes.html#t:Name">Name</a>) -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:addToSeat">addToSeat</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="DataTypes.html#t:Name">Name</a>, <a href="DataTypes.html#t:Name">Name</a>) -&gt; [<a href="DataTypes.html#t:Name">Name</a>] -&gt; [<a href="DataTypes.html#t:Name">Name</a>]</li><li class="src short"><a href="#v:play">play</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Event">Event</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:baseAct">baseAct</a> :: <a href="DataTypes.html#t:Game">Game</a></li><li class="src short"><a href="#v:broadcast">broadcast</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:draw">draw</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:getHand">getHand</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:GameState">GameState</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="DataTypes.html#t:Hand">Hand</a></li><li class="src short"><a href="#v:draw1">draw1</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:taxes">taxes</a> :: <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:cardFromDeck">cardFromDeck</a> :: <a href="DataTypes.html#t:GameState">GameState</a> -&gt; (<a href="DataTypes.html#t:Card">Card</a>, <a href="DataTypes.html#t:GameState">GameState</a>)</li><li class="src short"><a href="#v:cardToPile">cardToPile</a> :: <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:cardFromHand-39-">cardFromHand'</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:isTurn">isTurn</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:GameState">GameState</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:nextTurn">nextTurn</a> :: <a href="DataTypes.html#t:Step">Step</a></li><li class="src short"><a href="#v:win">win</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:doNothing" class="def">doNothing</a> :: <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#doNothing" class="link">Source</a> <a href="#v:doNothing" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:fromStep" class="def">fromStep</a> :: <a href="DataTypes.html#t:Step">Step</a> -&gt; <a href="DataTypes.html#t:Game">Game</a> <a href="src/BaseGame.html#fromStep" class="link">Source</a> <a href="#v:fromStep" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:if-39--39-" class="def">if''</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; (a -&gt; a) -&gt; a -&gt; a <a href="src/BaseGame.html#if%27%27" class="link">Source</a> <a href="#v:if-39--39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-37-" class="def">(%)</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="src/BaseGame.html#%25" class="link">Source</a> <a href="#v:-37-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-37--37-" class="def">(%%)</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="src/BaseGame.html#%25%25" class="link">Source</a> <a href="#v:-37--37-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:illegal" class="def">illegal</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Game">Game</a> <a href="src/BaseGame.html#illegal" class="link">Source</a> <a href="#v:illegal" class="selflink">#</a></p><div class="doc"><p>Returns a game where the move has not occured and a penalty has been given.
 Should be used with <code>doOnly</code></p></div></div><div class="top"><p class="src"><a id="v:penalty" class="def">penalty</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#penalty" class="link">Source</a> <a href="#v:penalty" class="selflink">#</a></p><div class="doc"><p>A penalty which does not end the turn</p></div></div><div class="top"><p class="src"><a id="v:broadcastp" class="def">broadcastp</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#broadcastp" class="link">Source</a> <a href="#v:broadcastp" class="selflink">#</a></p><div class="doc"><p>Broadcast a message while identifying the player it came from.</p></div></div><div class="top"><p class="src"><a id="v:sayAct" class="def">sayAct</a> :: <a href="DataTypes.html#t:Game">Game</a> <a href="src/BaseGame.html#sayAct" class="link">Source</a> <a href="#v:sayAct" class="selflink">#</a></p><div class="doc"><p>Broadcast the message a player sent with their action.</p></div></div><div class="top"><p class="src"><a id="v:addPlayer" class="def">addPlayer</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="DataTypes.html#t:Name">Name</a>, <a href="DataTypes.html#t:Name">Name</a>) -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#addPlayer" class="link">Source</a> <a href="#v:addPlayer" class="selflink">#</a></p><div class="doc"><p>Add a player to the game</p></div></div><div class="top"><p class="src"><a id="v:addToSeat" class="def">addToSeat</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="DataTypes.html#t:Name">Name</a>, <a href="DataTypes.html#t:Name">Name</a>) -&gt; [<a href="DataTypes.html#t:Name">Name</a>] -&gt; [<a href="DataTypes.html#t:Name">Name</a>] <a href="src/BaseGame.html#addToSeat" class="link">Source</a> <a href="#v:addToSeat" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:play" class="def">play</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Event">Event</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#play" class="link">Source</a> <a href="#v:play" class="selflink">#</a></p><div class="doc"><p>Play a move and tidy up the game state.</p></div></div><div class="top"><p class="src"><a id="v:baseAct" class="def">baseAct</a> :: <a href="DataTypes.html#t:Game">Game</a> <a href="src/BaseGame.html#baseAct" class="link">Source</a> <a href="#v:baseAct" class="selflink">#</a></p><div class="doc"><p>The default behaviour.
 Draws always succeed, a card may be played if it is in the player's hand, it is the player's turn and it matches either the suit or rank of the previous card.
 Timeouts give one penalty card to the player whose turn it is.</p></div></div><div class="top"><p class="src"><a id="v:broadcast" class="def">broadcast</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#broadcast" class="link">Source</a> <a href="#v:broadcast" class="selflink">#</a></p><div class="doc"><p>Add a message to the list of messages. Will be seen by all players by default.</p></div></div><div class="top"><p class="src"><a id="v:draw" class="def">draw</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#draw" class="link">Source</a> <a href="#v:draw" class="selflink">#</a></p><div class="doc"><p>Move n cards from the deck to a player's hand</p></div></div><div class="top"><p class="src"><a id="v:getHand" class="def">getHand</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:GameState">GameState</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="DataTypes.html#t:Hand">Hand</a> <a href="src/BaseGame.html#getHand" class="link">Source</a> <a href="#v:getHand" class="selflink">#</a></p><div class="doc"><p>Get the hand of the current player.</p></div></div><div class="top"><p class="src"><a id="v:draw1" class="def">draw1</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#draw1" class="link">Source</a> <a href="#v:draw1" class="selflink">#</a></p><div class="doc"><p>Move a single card from the deck to a player's hand.</p></div></div><div class="top"><p class="src"><a id="v:taxes" class="def">taxes</a> :: <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#taxes" class="link">Source</a> <a href="#v:taxes" class="selflink">#</a></p><div class="doc"><p>If any players have more than their share of cards, give return them to the deck (so that players can always draw cards and be given penalties).</p></div></div><div class="top"><p class="src"><a id="v:cardFromDeck" class="def">cardFromDeck</a> :: <a href="DataTypes.html#t:GameState">GameState</a> -&gt; (<a href="DataTypes.html#t:Card">Card</a>, <a href="DataTypes.html#t:GameState">GameState</a>) <a href="src/BaseGame.html#cardFromDeck" class="link">Source</a> <a href="#v:cardFromDeck" class="selflink">#</a></p><div class="doc"><p>Remove the top card of the deck shuffling the pile back in and applying taxes if necessary.</p></div></div><div class="top"><p class="src"><a id="v:cardToPile" class="def">cardToPile</a> :: <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#cardToPile" class="link">Source</a> <a href="#v:cardToPile" class="selflink">#</a></p><div class="doc"><p>Put a card on the pile</p></div></div><div class="top"><p class="src"><a id="v:cardFromHand-39-" class="def">cardFromHand'</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Card">Card</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#cardFromHand%27" class="link">Source</a> <a href="#v:cardFromHand-39-" class="selflink">#</a></p><div class="doc"><p>Remove a card from a players hand.</p></div></div><div class="top"><p class="src"><a id="v:isTurn" class="def">isTurn</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:GameState">GameState</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/BaseGame.html#isTurn" class="link">Source</a> <a href="#v:isTurn" class="selflink">#</a></p><div class="doc"><p>Test if it is a player's turn.</p></div></div><div class="top"><p class="src"><a id="v:nextTurn" class="def">nextTurn</a> :: <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#nextTurn" class="link">Source</a> <a href="#v:nextTurn" class="selflink">#</a></p><div class="doc"><p>Advance the turn order by one.</p></div></div><div class="top"><p class="src"><a id="v:win" class="def">win</a> :: <a href="DataTypes.html#t:Name">Name</a> -&gt; <a href="DataTypes.html#t:Step">Step</a> <a href="src/BaseGame.html#win" class="link">Source</a> <a href="#v:win" class="selflink">#</a></p><div class="doc"><p>incomplete?</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>